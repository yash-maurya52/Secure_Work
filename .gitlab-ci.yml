stages:
  - test

include:
  - template: Security/SAST.gitlab-ci.yml

variables:
  # Enable Semgrep with OWASP rules (GitLab's built-in version)
  SAST_DEFAULT_ANALYZERS: "semgrep"
  SEMGREP_RULES: "p/owasp-top-ten"  # GitLab's predefined rule set
  SAST_DISABLE_DIND: "true"         # Disable Docker-in-Docker if not needed

# Optional: Override the SAST job to add custom behavior
sast:
  stage: test
  artifacts:
    reports:
      sast: gl-sast-report.json
  script:
    - echo "Using GitLab's built-in Semgrep scanner with OWASP rules..."
    - /analyzer run